"""
  Project: Homework 13.4
  Author: 최민수
  StudentID: 21511796
  Date of last update: June. 7, 2021
  Detail: K-means clustering 기능 구현. 10년간의 8지역의 12월 기온 데이터를 활용.
"""
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.decomposition import PCA

temp_ids = ['서울', '인천', '강릉', '대전', '광주', '대구', '부산', '제주']
df_means = pd.DataFrame({1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[],11:[],12:[]},index = [])

yr_ids = [2011,2012,2013,2014,2015,2016,2017,2018,2019,2020]
tempdata = [
    {   #서울
        1:[-7.2, -2.8, -3.4, -0.7, -0.9, -3.2, -1.8, -4, -0.9, 1.6],
        2:[1.2, -2, -1.2, 1.9, 1, 0.2, -0.2, -1.6, 1, 2.5],
        3:[3.6, 5.1, 5.1, 7.9, 6.3, 7, 6.3, 8.1, 7.1, 7.7],
        4:[10.7, 12.3, 10, 14, 13.3, 14.1, 13.9, 13, 12.1, 11.1],
        5:[17.9, 19.7, 18.2, 18.9, 18.9, 19.6, 19.5, 18.2, 19.4, 18],
        6:[22, 24.1, 24.4, 23.1, 23.6, 23.6, 23.3, 23.1, 22.5, 23.9],
        7:[24.6, 25.4, 25.5, 26.1, 25.8, 26.2, 26.9, 27.8, 25.9, 24.1],
        8:[25.8, 27.1, 27.7, 25.2, 26.3, 28, 25.9, 28.8, 27.2, 26.5],
        9:[21.8, 21, 21.8, 22.1, 22.4, 23.1, 22.1, 21.5, 22.6, 21.4],
        10:[14.2, 15.3, 15.8, 15.6, 15.5, 16.1, 16.4, 13.1, 16.4, 14.3],
        11:[10.7, 5.5, 6.2, 9, 8.9, 6.8, 5.6, 7.8, 7.6, 8],
        12:[-0.9, -4.1, -0.2, -2.9, 1.6, 1.2, -1.9, -0.6, 1.4, -0.3]
    },
    {   #인천
        1:[-5.6, -1.9, -2.9, -0.3, -0.8, -2.2, -0.9, -3.8, -0.5, 1.8],
        2:[1.4, -1.2, -1.4, 1.4, 1.2, 0.9, 0.2, -1.8, 0.8, 2.5],
        3:[4.2, 5.2, 4.1, 7, 5.4, 6.4, 5.8, 6.9, 6.4, 7.1],
        4:[10, 11.7, 8.9, 12.3, 12.5, 12.7, 12.4, 11.9, 11.3, 10.4],
        5:[16.8, 18.1, 16, 16.9, 17, 18.3, 17.6, 17, 17.6, 16.7],
        6:[20, 22.9, 22.2, 21.8, 21.8, 22.1, 21.7, 21.2, 21.3, 21.8],
        7:[23.9, 24.5, 24.1, 24.8, 24.5, 25.2, 25.8, 26.6, 25, 23.2],
        8:[25, 26.7, 26.9, 24.5, 25.8, 27.4, 25.4, 28.1, 26.9, 25.9],
        9:[21.7, 21, 21.5, 22, 22.5, 22.9, 21.9, 21.6, 22.5, 21.3],
        10:[14.8, 15.6, 15.9, 15.9, 16, 16.2, 15.7, 13.8, 16.8, 14.8],
        11:[11.4, 6.1, 6.8, 9.2, 9.4, 7.4, 5.9, 8.5, 8.2, 8.3],
        12:[0.4, -3.7, 0.4, -2.1, 2.4, 2.2, -1.3, -0.2, 2, 0.2],
    },
    {   #강릉
        1:[-2.8, -0.1, -0.5, 2.3, 2.2, 0.4, 1.5, -0.2, 2.8, 4.4],
        2:[2.5, 0.4, 1.8, 1.3, 3.1, 1.9, 3.5, 0.5, 3.8, 5],
        3:[5.5, 5.7, 7.4, 8.3, 8.2, 7.9, 7.1, 9.2, 8.9, 8.7],
        4:[11.7, 13.3, 10.8, 14.1, 12.1, 14.1, 15.4, 14.5, 12.6, 11.8],
        5:[16, 17.6, 18.1, 20, 20, 19.3, 20.3, 17.3, 21, 18.3],
        6:[22, 20.6, 21.5, 20.9, 21, 21.9, 21.2, 23.2, 21.4, 24.1],
        7:[23.4, 25.3, 27, 26.1, 23.8, 24.1, 26.8, 26.8, 25.8, 22.4],
        8:[25.3, 25.1, 28.5, 23.7, 25.8, 25.8, 24.3, 26.2, 26.5, 27],
        9:[20.2, 20.2, 20.8, 20.9, 20.2, 20.6, 21.3, 20, 21.5, 20.6],
        10:[14.8, 15.8, 15.8, 15.9, 16, 15.6, 15.2, 14.1, 16.6, 15.1],
        11:[11.2, 7.8, 8.8, 10.5, 9.9, 9.1, 9, 10, 10.2, 11],
        12:[1.5, -0.1, 3.1, 1.1, 4.9, 5, 1.5, 2.7, 5.3, 3],
    },
    {   #대전
        1:[-5.7, -1.5, -2.6, -0.1, 0, -1.3, -0.4, -2.5, 0, 2.7],
        2:[1.8, -1, 0, 2.7, 1.9, 1.5, 1.2, -0.4, 2, 3.6],
        3:[4.5, 5.7, 6.6, 8.3, 7.2, 7.5, 6.8, 8.7, 7.7, 8.5],
        4:[11.6, 13.2, 10.6, 14.3, 13.3, 14.8, 14.5, 13.9, 12.9, 11.5],
        5:[18.1, 19.8, 18.8, 19.4, 19.5, 19.8, 19.6, 19.2, 19.7, 18.8],
        6:[22.7, 23.8, 23.9, 22.9, 23.4, 23.7, 23.3, 23.6, 22.6, 24.1],
        7:[25.7, 26.3, 26.8, 25.9, 25.4, 26.6, 27.1, 27.9, 25.8, 23.6],
        8:[25.8, 27.1, 27.8, 24.2, 26.4, 27.9, 26, 29, 27.2, 27.5],
        9:[21.2, 20.6, 21.4, 21.6, 21.7, 22.4, 21.1, 21.2, 22.5, 21.2],
        10:[13.5, 14.3, 15.5, 14.9, 15.5, 15.7, 15.4, 13, 16.2, 14.2],
        11:[11.2, 6, 6.7, 8.5, 10.1, 7.2, 6.4, 8, 8.7, 8.6],
        12:[0.4, -3, 1.3, -1.3, 3.1, 2.5, -0.4, 0.6, 2.6, 0.5],
    },
    {#광주
        1:[-3.4, 0.4, 0, 2.1, 1.7, 0.9, 2, -0.2, 1.8, 4.6],
        2:[3.1, 0.4, 2, 4.2, 3, 3.3, 2.9, 1.8, 3.6, 5.3],
        3:[5.3, 6.5, 7.6, 8.6, 8, 8.4, 7.4, 10, 8.4, 9],
        4:[12.2, 13.6, 11.4, 14.5, 13.9, 15.5, 15.1, 15.1, 13, 11.5],
        5:[19, 20, 19.1, 19.2, 19.4, 19.8, 19.8, 19.5, 19.2, 18.8],
        6:[23.3, 23.4, 23.9, 22.9, 22.5, 23, 23.1, 23.6, 22, 23.6],
        7:[26.5, 26.4, 27.1, 25.2, 25.4, 26.9, 27.8, 28.3, 25.3, 23.4],
        8:[25.9, 27.6, 28.4, 24.4, 26, 27.8, 27, 28.4, 27, 27.6],
        9:[22.7, 21.3, 22.6, 22.3, 22, 23, 22.4, 21.6, 22.9, 21.3],
        10:[15.4, 15.9, 16.8, 16.4, 16.9, 17.2, 17, 14.5, 17.1, 15.7],
        11:[12.6, 8.1, 8.6, 10.3, 11.6, 9.6, 8.8, 9.9, 10.8, 10.5],
        12:[2.2, 0.4, 2.9, 1.2, 5.3, 4.7, 1.9, 3.2, 4.8, 2.7],
    },
    {#대구
        1:[-2.5, 0.8, -0.1, 2.8, 2.3, -0.2, 1.1, -0.9, 1.7, 3.8],
        2:[4.2, 1.1, 2.6, 4.5, 3.8, 3.1, 3.2, 1.3, 4, 4.9],
        3:[7, 7.7, 9.8, 9.7, 9.2, 8.8, 7.9, 9.2, 9.4, 9.5],
        4:[13.7, 15.1, 12.3, 15.5, 14.6, 14.9, 15.7, 15, 13.5, 12.6],
        5:[18.8, 20.1, 20.3, 21.2, 21.7, 20, 20.8, 19.2, 20.7, 19.4],
        6:[24.3, 23.2, 24.3, 23.4, 22.9, 23.4, 23.3, 23.6, 22.8, 24.5],
        7:[26.8, 27.5, 28.7, 27, 25, 26.4, 28, 28.2, 25.8, 23.2],
        8:[26.2, 27.9, 29, 24.7, 26, 27.6, 26.4, 27.7, 27.4, 28.6],
        9:[23, 21.7, 23, 22.5, 20.6, 21.9, 21.5, 21, 22.6, 21.2],
        10:[15.7, 15.8, 17.2, 16.4, 15.8, 16.6, 16.2, 14.3, 16.8, 15.4],
        11:[11.9, 8.2, 8.9, 10.3, 11, 8.8, 7.8, 8.8, 9.8, 9.7],
        12:[2.3, -0.3, 3.5, 1.2, 4.5, 4, 0.7, 2, 3.5, 1.6],
    },
    {#부산
        1:[-0.7, 2.8, 2.5, 5, 4.7, 3.1, 4.1, 1.9, 4.5, 6.4],
        2:[6.1, 2.8, 4.7, 5.8, 5.4, 5.5, 5.5, 3.9, 6.6, 7.1],
        3:[7.4, 8.3, 10.2, 9.8, 9.5, 9.9, 9, 10, 10.5, 10.4],
        4:[13.1, 14, 12.6, 14.6, 13.9, 15.1, 15, 14.5, 13.4, 12.6],
        5:[17.3, 18.9, 18.2, 18.7, 18.8, 19.3, 19, 17.8, 19.3, 17.9],
        6:[21.3, 21.6, 21.9, 21.4, 21, 21.9, 21.3, 21.5, 21.1, 22.4],
        7:[25.1, 25.5, 26.1, 24.8, 23.9, 25.3, 26.1, 26.7, 24.3, 22.1],
        8:[25.8, 27.5, 28, 24.2, 26.1, 27.7, 27, 27.9, 27, 27.2],
        9:[23.3, 22.2, 23.7, 22.7, 22.1, 22.9, 22.6, 21.9, 23.1, 21.9],
        10:[17.6, 17.8, 18.9, 17.9, 18.1, 18.7, 18.1, 16.4, 18.6, 17.3],
        11:[14.1, 10.1, 10.9, 12.7, 13.6, 11.8, 11.2, 12.4, 13, 12.4],
        12:[4.4, 2.9, 5.4, 3.5, 7.9, 7.3, 3.6, 5.7, 7, 4.3],
    },
    {#제주
        1:[2.3, 5.4, 5.6, 6.8, 7.4, 6.1, 6.6, 4.9, 6.4, 8.9],
        2:[7, 4.8, 6.2, 7.5, 7.3, 7.3, 6.8, 5.5, 7.4, 9.1],
        3:[7.8, 9, 10, 10.7, 10.4, 10.8, 9.8, 11.4, 10.8, 11.5],
        4:[13.2, 14.5, 13.5, 14.8, 15.1, 15.6, 15.7, 15.9, 14.7, 13.2],
        5:[18.2, 19, 18.6, 19.1, 18.8, 18.9, 19.5, 19.1, 20, 18.8],
        6:[21.7, 22.3, 21.7, 21.8, 22, 22.2, 22, 22.3, 21.5, 22.4],
        7:[27.3, 26.6, 28.7, 25.1, 25.6, 27.4, 29.2, 27.3, 25.2, 24.2],
        8:[26, 27.8, 29.1, 25.1, 26.4, 28.5, 28.7, 28.8, 27.7, 29.4],
        9:[23.1, 22, 24, 23.5, 23.2, 23.9, 24, 23.9, 24, 22.9],
        10:[17.9, 18.4, 19.2, 19.1, 19.2, 20.1, 19.3, 17.9, 19.7, 18.4],
        11:[15.7, 12, 12.9, 13.9, 15.2, 13.7, 12.6, 13.9, 14.6, 14.1],
        12:[7.1, 6.6, 8.1, 7.3, 10, 9.5, 7.2, 8.7, 9.7, 7.7],
    }

]

# 데이터의 월평균을 계산하여 데이터프레임으로 가공
for data in tempdata:
    df = pd.DataFrame(data, index=yr_ids)
    index = len(df_means)
    df_means.loc[index] = df.mean()

# 데이터프레임의 ndarray 변환
df_result = df_means.to_numpy()

# 클러스터 지정
kmeans = KMeans(n_clusters = 3)
kmeans.fit(df_means)

# 군집화 초기설정
pca = PCA(n_components=2)
pca_transformed = pca.fit_transform(df_result)

df_means['pca_x'] = pca_transformed[:,0]
df_means['pca_y'] = pca_transformed[:,1]

# 군집화 데이터만 추출 후 ndarray로 변환
df_means = df_means.iloc[:,12:]
df_means = df_means.to_numpy()

# 데이터 출력
plt.scatter(df_means[:, 0], df_means[:, 1], c=kmeans.labels_, cmap='rainbow')
plt.show()
